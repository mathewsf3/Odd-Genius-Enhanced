{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mathe\\\\OneDrive\\\\Desktop\\\\odd-genius - WORKING - Copy - Copy\\\\frontend\\\\src\\\\pages\\\\SpecialMatch.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { Box, Container, Spinner, useColorModeValue, Tabs, TabList, TabPanels, Tab, TabPanel, Flex, Badge, Tooltip, Button } from '@chakra-ui/react';\nimport MatchHeader from '../components/match/MatchHeader';\nimport ErrorMessage from '../components/ErrorMessage';\nimport axios from 'axios';\n\n// Component imports\nimport CustomHeadToHeadTab from '../components/match/CustomHeadToHeadTab';\nimport CornerTabCustom from '../components/match/CornerTabCustom';\nimport CustomCardsTab from '../components/match/CustomCardsTab';\nimport CustomBTTSTab from '../components/match/CustomBTTSTab';\nimport CustomPlayerStatsTab from '../components/match/CustomPlayerStatsTab';\nimport CustomLeagueTab from '../components/match/CustomLeagueTab';\n\n// Import services\nimport cornerStatsService from '../services/cornerStatsService';\nimport cardStatsService from '../services/cardStatsService';\nimport bttsStatsService from '../services/bttsStatsService';\nimport playerStatsService from '../services/playerStatsService';\nimport leagueService from '../services/leagueService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Initial match data structure - will be populated with real data from API\nconst INITIAL_MATCH_DATA = {\n  id: '',\n  homeTeam: {\n    id: '',\n    name: '',\n    logo: ''\n  },\n  awayTeam: {\n    id: '',\n    name: '',\n    logo: ''\n  },\n  league: {\n    id: '',\n    name: '',\n    country: '',\n    logo: ''\n  },\n  date: '',\n  time: '',\n  startTime: '',\n  status: '',\n  venue: '',\n  odds: {\n    home: 0,\n    draw: 0,\n    away: 0\n  },\n  probability: {\n    home: '0%',\n    draw: '0%',\n    away: '0%'\n  },\n  score: {\n    home: 0,\n    away: 0\n  }\n};\nconst SpecialMatch = ({\n  matchId: propMatchId\n}) => {\n  const params = useParams();\n  const matchId = propMatchId || params.id || '1530359'; // Use prop, then route param, then default (working match ID)\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [h2hData, setH2hData] = useState(null);\n  const [cornerStatsData, setCornerStatsData] = useState(null);\n  const [cardStatsData, setCardStatsData] = useState(null);\n  const [bttsStatsData, setBttsStatsData] = useState(null);\n  const [playerStatsData, setPlayerStatsData] = useState(null);\n  const [leagueStandingsData, setLeagueStandingsData] = useState(null);\n  const [tabIndex, setTabIndex] = useState(0);\n  const [gameCount, setGameCount] = useState(10);\n  const [matchData, setMatchData] = useState(INITIAL_MATCH_DATA);\n  const bgColor = useColorModeValue('white', 'gray.800');\n\n  // Function to fetch real match data based on route parameter\n  const fetchMatchData = async id => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      console.log(`ðŸ” [SpecialMatch] Fetching match data for ID: ${id}`);\n      console.log(`ðŸ” [SpecialMatch] Previous match data:`, matchData);\n\n      // Clear all existing data when fetching new match\n      setH2hData(null);\n      setCornerStatsData(null);\n      setCardStatsData(null);\n      setBttsStatsData(null);\n      setPlayerStatsData(null);\n      setLeagueStandingsData(null);\n\n      // Try to fetch match data from backend API\n      const response = await axios.get(`http://localhost:5000/api/matches/${id}`);\n      if (response.data && response.data.success && response.data.result) {\n        console.log('âœ… [SpecialMatch] Successfully fetched real match data from backend:', response.data.result);\n        setMatchData(response.data.result);\n        setIsLoading(false);\n        return response.data.result;\n      } else {\n        console.log('âš ï¸ [SpecialMatch] No match data found in backend, trying AllSportsAPI directly');\n        // Try to fetch from AllSportsAPI directly\n        const directResponse = await axios.get(`https://apiv2.allsportsapi.com/football/?met=Fixtures&APIkey=9af98e929db6f98a1561c444b6179b5740a69b942cb3ffcc62b80a7eda5128b4&matchId=${id}`);\n        if (directResponse.data && directResponse.data.success && directResponse.data.result && directResponse.data.result.length > 0) {\n          const matchResult = directResponse.data.result[0];\n          console.log('âœ… [SpecialMatch] Successfully fetched match data from AllSportsAPI:', matchResult);\n\n          // Transform the API response to our Match interface\n          const transformedMatch = {\n            id: matchResult.match_id || id,\n            homeTeam: {\n              id: `team-${matchResult.match_hometeam_id}`,\n              name: matchResult.match_hometeam_name || 'Home Team',\n              logo: matchResult.team_home_badge || ''\n            },\n            awayTeam: {\n              id: `team-${matchResult.match_awayteam_id}`,\n              name: matchResult.match_awayteam_name || 'Away Team',\n              logo: matchResult.team_away_badge || ''\n            },\n            league: {\n              id: matchResult.league_id || '',\n              name: matchResult.league_name || 'Unknown League',\n              country: matchResult.country_name || '',\n              logo: matchResult.league_logo || ''\n            },\n            date: matchResult.match_date || '',\n            time: matchResult.match_time || '',\n            startTime: `${matchResult.match_date}T${matchResult.match_time}:00`,\n            status: matchResult.match_status || 'NS',\n            venue: matchResult.match_stadium || '',\n            odds: {\n              home: parseFloat(matchResult.match_hometeam_score) || 0,\n              draw: 0,\n              away: parseFloat(matchResult.match_awayteam_score) || 0\n            },\n            probability: {\n              home: '0%',\n              draw: '0%',\n              away: '0%'\n            },\n            score: {\n              home: parseInt(matchResult.match_hometeam_score) || 0,\n              away: parseInt(matchResult.match_awayteam_score) || 0\n            }\n          };\n          console.log('ðŸ”„ [SpecialMatch] Transformed match data:', transformedMatch);\n          setMatchData(transformedMatch);\n          setIsLoading(false);\n          return transformedMatch;\n        } else {\n          throw new Error('No match data found in AllSportsAPI');\n        }\n      }\n    } catch (error) {\n      console.error('âŒ [SpecialMatch] Error fetching match data:', error);\n      setError(`Unable to load match data for ID: ${id}. This match may not be available in the current live or upcoming matches. Please try selecting a different match from the dashboard.`);\n      setIsLoading(false);\n      return null;\n    }\n  };\n\n  // Function to fetch corner stats data\n  const fetchCornerStatsData = async (count = gameCount) => {\n    try {\n      console.log(`Fetching corner statistics with ${count} games - fresh API call`);\n\n      // First clear existing data only if count has changed to ensure we see a loading state\n      if (count !== gameCount) {\n        setCornerStatsData(null);\n      }\n\n      // Get team IDs - remove \"team-\" prefix if it exists since API expects numeric IDs\n      const rawHomeTeamId = matchData.homeTeam.id; // e.g. \"team-93\"\n      const rawAwayTeamId = matchData.awayTeam.id; // e.g. \"team-4973\"\n\n      // Extract team IDs - handle both numeric IDs and name-based IDs\n      const homeTeamId = rawHomeTeamId.startsWith('team-') ? rawHomeTeamId.replace('team-', '') : rawHomeTeamId;\n      const awayTeamId = rawAwayTeamId.startsWith('team-') ? rawAwayTeamId.replace('team-', '') : rawAwayTeamId;\n      console.log(`Fetching corner statistics for teams - Raw IDs: ${rawHomeTeamId} vs ${rawAwayTeamId}`);\n      console.log(`Using processed IDs: ${homeTeamId} vs ${awayTeamId} with ${count} games`);\n\n      // Check if both teams have numeric IDs (required for API calls)\n      const homeTeamHasNumericId = /^\\d+$/.test(homeTeamId);\n      const awayTeamHasNumericId = /^\\d+$/.test(awayTeamId);\n      if (!homeTeamHasNumericId || !awayTeamHasNumericId) {\n        console.warn('âš ï¸ [SpecialMatch] Teams do not have numeric IDs, skipping corner stats:', {\n          homeTeamId,\n          awayTeamId,\n          homeTeamHasNumericId,\n          awayTeamHasNumericId\n        });\n        setCornerStatsData(null);\n        return;\n      }\n\n      // Add a small delay for better UX when using cached data\n      if (count === gameCount) {\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n      const data = await cornerStatsService.fetchCornerStats(homeTeamId, awayTeamId, count);\n      console.log(`Successfully fetched corner stats data for ${count} games`);\n\n      // Update gameCount state if it has changed\n      if (count !== gameCount) {\n        setGameCount(count);\n      }\n      setCornerStatsData(data);\n\n      // Clear any previous errors\n      if (error) {\n        setError(null);\n      }\n      return data;\n    } catch (err) {\n      console.error('Error fetching corner stats data:', err);\n      // Set error state to inform the user that corner stats data couldn't be loaded\n      setError('Unable to load corner statistics data. Please try again later.');\n      throw err; // Rethrow to allow the component to handle it\n    }\n  };\n\n  // Function to fetch card stats data\n  const fetchCardStatsData = async (count = gameCount) => {\n    try {\n      console.log(`Fetching card statistics with ${count} games - fresh API call`);\n\n      // First clear existing data only if count has changed to ensure we see a loading state\n      if (count !== gameCount) {\n        setCardStatsData(null);\n      }\n\n      // Get team IDs - remove \"team-\" prefix if it exists since API expects numeric IDs\n      const rawHomeTeamId = matchData.homeTeam.id; // e.g. \"team-93\"\n      const rawAwayTeamId = matchData.awayTeam.id; // e.g. \"team-4973\"\n\n      // Extract team IDs - handle both numeric IDs and name-based IDs\n      const homeTeamId = rawHomeTeamId.startsWith('team-') ? rawHomeTeamId.replace('team-', '') : rawHomeTeamId;\n      const awayTeamId = rawAwayTeamId.startsWith('team-') ? rawAwayTeamId.replace('team-', '') : rawAwayTeamId;\n      console.log(`Fetching card statistics for teams - Raw IDs: ${rawHomeTeamId} vs ${rawAwayTeamId}`);\n      console.log(`Using processed IDs: ${homeTeamId} vs ${awayTeamId} with ${count} games`);\n\n      // Check if both teams have numeric IDs (required for API calls)\n      const homeTeamHasNumericId = /^\\d+$/.test(homeTeamId);\n      const awayTeamHasNumericId = /^\\d+$/.test(awayTeamId);\n      if (!homeTeamHasNumericId || !awayTeamHasNumericId) {\n        console.warn('âš ï¸ [SpecialMatch] Teams do not have numeric IDs, skipping card stats:', {\n          homeTeamId,\n          awayTeamId,\n          homeTeamHasNumericId,\n          awayTeamHasNumericId\n        });\n        setCardStatsData(null);\n        return;\n      }\n\n      // Add a small delay for better UX when using cached data\n      if (count === gameCount) {\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n      const data = await cardStatsService.fetchCardStats(homeTeamId, awayTeamId, count);\n      console.log(`Successfully fetched card stats data for ${count} games`);\n\n      // Update gameCount state if it has changed\n      if (count !== gameCount) {\n        setGameCount(count);\n      }\n      setCardStatsData(data);\n\n      // Clear any previous errors\n      if (error) {\n        setError(null);\n      }\n      return data;\n    } catch (err) {\n      console.error('Error fetching card stats data:', err);\n      // Set error state to inform the user that card stats data couldn't be loaded\n      setError('Unable to load card statistics data. Please try again later.');\n      throw err; // Rethrow to allow the component to handle it\n    }\n  };\n\n  // Function to fetch BTTS stats data\n  const fetchBTTSStatsData = async (count = gameCount) => {\n    try {\n      console.log(`Fetching BTTS statistics with ${count} games - fresh API call`);\n\n      // First clear existing data only if count has changed to ensure we see a loading state\n      if (count !== gameCount) {\n        setBttsStatsData(null);\n      }\n\n      // Get team IDs - remove \"team-\" prefix if it exists since API expects numeric IDs\n      const rawHomeTeamId = matchData.homeTeam.id; // e.g. \"team-93\"\n      const rawAwayTeamId = matchData.awayTeam.id; // e.g. \"team-4973\"\n\n      // Extract team IDs - handle both numeric IDs and name-based IDs\n      const homeTeamId = rawHomeTeamId.startsWith('team-') ? rawHomeTeamId.replace('team-', '') : rawHomeTeamId;\n      const awayTeamId = rawAwayTeamId.startsWith('team-') ? rawAwayTeamId.replace('team-', '') : rawAwayTeamId;\n      console.log(`Fetching BTTS statistics for teams - Raw IDs: ${rawHomeTeamId} vs ${rawAwayTeamId}`);\n      console.log(`Using processed IDs: ${homeTeamId} vs ${awayTeamId} with ${count} games`);\n\n      // Check if both teams have numeric IDs (required for API calls)\n      const homeTeamHasNumericId = /^\\d+$/.test(homeTeamId);\n      const awayTeamHasNumericId = /^\\d+$/.test(awayTeamId);\n      if (!homeTeamHasNumericId || !awayTeamHasNumericId) {\n        console.warn('âš ï¸ [SpecialMatch] Teams do not have numeric IDs, skipping BTTS stats:', {\n          homeTeamId,\n          awayTeamId,\n          homeTeamHasNumericId,\n          awayTeamHasNumericId\n        });\n        setBttsStatsData(null);\n        return;\n      }\n\n      // Add a small delay for better UX when using cached data\n      if (count === gameCount) {\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n      const data = await bttsStatsService.fetchBTTSStats(homeTeamId, awayTeamId, count);\n      console.log(`Successfully fetched BTTS stats data for ${count} games`);\n\n      // Update gameCount state if it has changed\n      if (count !== gameCount) {\n        setGameCount(count);\n      }\n      setBttsStatsData(data);\n\n      // Clear any previous errors\n      if (error) {\n        setError(null);\n      }\n      return data;\n    } catch (err) {\n      console.error('Error fetching BTTS stats data:', err);\n      // Set error state to inform the user that BTTS stats data couldn't be loaded\n      setError('Unable to load BTTS statistics data. Please try again later.');\n      throw err; // Rethrow to allow the component to handle it\n    }\n  };\n\n  // Function to fetch player stats data\n  const fetchPlayerStatsData = async (count = gameCount) => {\n    try {\n      console.log(`Fetching player statistics with ${count} games - fresh API call`);\n\n      // First clear existing data to ensure we see a loading state\n      setPlayerStatsData(null);\n\n      // Get team IDs - remove \"team-\" prefix if it exists since API expects numeric IDs\n      const rawHomeTeamId = matchData.homeTeam.id; // e.g. \"team-93\"\n      const rawAwayTeamId = matchData.awayTeam.id; // e.g. \"team-4973\"\n\n      // Extract team IDs - handle both numeric IDs and name-based IDs\n      const homeTeamId = rawHomeTeamId.startsWith('team-') ? rawHomeTeamId.replace('team-', '') : rawHomeTeamId;\n      const awayTeamId = rawAwayTeamId.startsWith('team-') ? rawAwayTeamId.replace('team-', '') : rawAwayTeamId;\n      const leagueId = matchData.league.id;\n      console.log(`Fetching player statistics for teams - Raw IDs: ${rawHomeTeamId} vs ${rawAwayTeamId}`);\n      console.log(`Using processed IDs: ${homeTeamId} vs ${awayTeamId} with league ID: ${leagueId} and ${count} games`);\n\n      // Check if both teams have numeric IDs (required for API calls)\n      const homeTeamHasNumericId = /^\\d+$/.test(homeTeamId);\n      const awayTeamHasNumericId = /^\\d+$/.test(awayTeamId);\n      if (!homeTeamHasNumericId || !awayTeamHasNumericId) {\n        console.warn('âš ï¸ [SpecialMatch] Teams do not have numeric IDs, skipping player stats:', {\n          homeTeamId,\n          awayTeamId,\n          homeTeamHasNumericId,\n          awayTeamHasNumericId\n        });\n        setPlayerStatsData(null);\n        return;\n      }\n\n      // Add a small delay for better UX\n      await new Promise(resolve => setTimeout(resolve, 500));\n      const data = await playerStatsService.fetchPlayerStats(homeTeamId, awayTeamId, leagueId, count);\n      console.log(`Successfully fetched player stats data for ${count} games`);\n\n      // Update gameCount state if it has changed\n      if (count !== gameCount) {\n        setGameCount(count);\n      }\n      setPlayerStatsData(data);\n\n      // Clear any previous errors\n      if (error) {\n        setError(null);\n      }\n      return data;\n    } catch (err) {\n      console.error('Error fetching player stats data:', err);\n      // Set error state to inform the user that player stats data couldn't be loaded\n      setError('Unable to load player statistics data. Please try again later.');\n      throw err; // Rethrow to allow the component to handle it\n    }\n  };\n\n  // Function to fetch league standings data\n  const fetchLeagueStandingsData = async () => {\n    try {\n      console.log(`Fetching league standings data - fresh API call`);\n\n      // First clear existing data to ensure we see a loading state\n      setLeagueStandingsData(null);\n\n      // Get league ID from match data\n      const leagueId = matchData.league.id;\n\n      // Get team IDs - remove \"team-\" prefix if it exists since API expects numeric IDs\n      const rawHomeTeamId = matchData.homeTeam.id; // e.g. \"team-93\"\n      const rawAwayTeamId = matchData.awayTeam.id; // e.g. \"team-4973\"\n\n      // Extract team IDs - handle both numeric IDs and name-based IDs\n      const homeTeamId = rawHomeTeamId.startsWith('team-') ? rawHomeTeamId.replace('team-', '') : rawHomeTeamId;\n      const awayTeamId = rawAwayTeamId.startsWith('team-') ? rawAwayTeamId.replace('team-', '') : rawAwayTeamId;\n      console.log(`Fetching league standings for league ID: ${leagueId}`);\n      console.log(`Home team ID: ${homeTeamId}, Away team ID: ${awayTeamId}`);\n\n      // Add a small delay for better UX\n      await new Promise(resolve => setTimeout(resolve, 500));\n      const data = await leagueService.fetchLeagueStandings(leagueId, homeTeamId, awayTeamId);\n      console.log(`Successfully fetched league standings data`);\n      setLeagueStandingsData(data);\n\n      // Clear any previous errors\n      if (error) {\n        setError(null);\n      }\n      return data;\n    } catch (err) {\n      console.error('Error fetching league standings data:', err);\n      // Set error state to inform the user that league standings data couldn't be loaded\n      setError('Unable to load league standings data. Please try again later.');\n      throw err; // Rethrow to allow the component to handle it\n    }\n  };\n\n  // Fetch all statistics data after match data is loaded\n  useEffect(() => {\n    // Only fetch stats if we have valid match data (team IDs are not empty)\n    if (matchData.homeTeam.id && matchData.awayTeam.id && matchData.homeTeam.id !== '' && matchData.awayTeam.id !== '') {\n      console.log('Match data loaded, now fetching all statistics...');\n      fetchCornerStatsData();\n      fetchCardStatsData();\n      fetchBTTSStatsData();\n      fetchPlayerStatsData();\n      fetchLeagueStandingsData();\n    }\n  }, [matchData.homeTeam.id, matchData.awayTeam.id]); // Trigger when team IDs change\n\n  // Listen for game count change events\n  useEffect(() => {\n    // Event handler for game count changes\n    const handleGameCountChange = e => {\n      const newGameCount = e.detail.gameCount;\n      const requiresRefetch = e.detail.requiresRefetch;\n      console.log(`Game count changed to ${newGameCount}, requires refetch: ${requiresRefetch}`);\n\n      // First update state\n      setGameCount(newGameCount);\n\n      // Clear existing data to indicate loading state\n      setCornerStatsData(null);\n      setCardStatsData(null);\n      setBttsStatsData(null);\n      setPlayerStatsData(null);\n\n      // Then trigger data refresh with full refetch from API\n      fetchCornerStatsData(newGameCount);\n      fetchCardStatsData(newGameCount);\n      fetchBTTSStatsData(newGameCount);\n      fetchPlayerStatsData(newGameCount);\n    };\n\n    // Add event listener\n    document.addEventListener('gameCountChange', handleGameCountChange);\n\n    // Clean up\n    return () => {\n      document.removeEventListener('gameCountChange', handleGameCountChange);\n    };\n  }, [/* no dependencies to ensure it's only set up once */]);\n\n  // Fetch match data when component mounts or matchId changes\n  useEffect(() => {\n    console.log(`SpecialMatch component mounted with matchId: ${matchId}`);\n    console.log(`Current match data:`, matchData);\n    console.log(`Route params:`, params);\n    console.log(`Prop matchId:`, propMatchId);\n    fetchMatchData(matchId);\n  }, [matchId]);\n\n  // Fetch H2H data using our service with UPDATED API KEY\n  useEffect(() => {\n    // Only fetch H2H data if we have valid match data\n    if (!matchData.homeTeam.id || !matchData.awayTeam.id || matchData.homeTeam.id === '' || matchData.awayTeam.id === '') {\n      console.log(\"Waiting for match data before fetching H2H data...\");\n      return;\n    }\n    console.log(\"Starting to fetch head-to-head data with updated API key...\");\n    const fetchH2HData = async () => {\n      try {\n        // Extract team IDs from the URL format\n        const homeTeamId = matchData.homeTeam.id.replace('team-', ''); // 93\n        const awayTeamId = matchData.awayTeam.id.replace('team-', ''); // 4973\n\n        console.log(`Fetching real H2H data for teams ${homeTeamId} vs ${awayTeamId}`);\n\n        // Check if both teams have numeric IDs (required for API calls)\n        const homeTeamHasNumericId = /^\\d+$/.test(homeTeamId);\n        const awayTeamHasNumericId = /^\\d+$/.test(awayTeamId);\n        if (!homeTeamHasNumericId || !awayTeamHasNumericId) {\n          console.warn('âš ï¸ [SpecialMatch] Teams do not have numeric IDs, skipping H2H data:', {\n            homeTeamId,\n            awayTeamId,\n            homeTeamHasNumericId,\n            awayTeamHasNumericId\n          });\n          setError('H2H data not available - teams do not have numeric IDs required for API calls');\n          return;\n        }\n\n        // Force use of real API data by directly calling the API\n        const apiKey = '9af98e929db6f98a1561c444b6179b5740a69b942cb3ffcc62b80a7eda5128b4';\n        const url = `https://apiv2.allsportsapi.com/football/?met=H2H&APIkey=${apiKey}&firstTeamId=${homeTeamId}&secondTeamId=${awayTeamId}`;\n\n        // Use a timeout to abort the request if it takes too long\n        const abortController = new AbortController();\n        const timeoutId = setTimeout(() => abortController.abort(), 10000);\n\n        // Make direct API call to ensure we get real data\n        const apiResponse = await axios.get(url, {\n          signal: abortController.signal,\n          decompress: true\n        });\n        clearTimeout(timeoutId);\n        console.log('API response received:', apiResponse.data.success === 1 ? 'Success' : 'Failed');\n\n        // Use the direct API response\n        const response = {\n          data: apiResponse.data\n        };\n        if (response.data && response.data.success === 1) {\n          // Transform the API response to match our H2HData interface\n          const apiH2H = response.data.result;\n          const transformedData = {\n            firstTeam: {\n              id: `team-${homeTeamId}`,\n              name: matchData.homeTeam.name,\n              logo: matchData.homeTeam.logo\n            },\n            secondTeam: {\n              id: `team-${awayTeamId}`,\n              name: matchData.awayTeam.name,\n              logo: matchData.awayTeam.logo\n            },\n            summary: {\n              totalMatches: apiH2H.H2H ? apiH2H.H2H.length : 0,\n              wins: {\n                firstTeam: 0,\n                secondTeam: 0,\n                draws: 0\n              },\n              goals: {\n                firstTeam: 0,\n                secondTeam: 0\n              }\n            },\n            matches: []\n          };\n\n          // Process match data and calculate statistics\n          if (apiH2H.H2H && apiH2H.H2H.length > 0) {\n            // Use all matches from the API response to ensure consistency with summary stats\n            const allMatches = apiH2H.H2H;\n            transformedData.summary.totalMatches = allMatches.length;\n\n            // Transform matches into our format\n            const processedMatches = allMatches.map(match => {\n              // Determine result (HOME, AWAY, DRAW)\n              const homeScore = parseInt(match.event_final_result.split(' - ')[0]);\n              const awayScore = parseInt(match.event_final_result.split(' - ')[1]);\n              let result = homeScore > awayScore ? 'HOME' : homeScore < awayScore ? 'AWAY' : 'DRAW';\n\n              // Count stats for summary - determine which team won or if it was a draw\n              if (result === 'HOME') {\n                if (match.home_team_key === homeTeamId) {\n                  // Home team is the first team and they won\n                  transformedData.summary.wins.firstTeam++;\n                } else {\n                  // Home team is the second team and they won\n                  transformedData.summary.wins.secondTeam++;\n                }\n              } else if (result === 'AWAY') {\n                if (match.away_team_key === homeTeamId) {\n                  // Away team is the first team and they won\n                  transformedData.summary.wins.firstTeam++;\n                } else {\n                  // Away team is the second team and they won\n                  transformedData.summary.wins.secondTeam++;\n                }\n              } else {\n                // It's a draw\n                transformedData.summary.wins.draws++;\n              }\n\n              // Count goals - homeScore and awayScore are already parsed as integers above\n              if (match.home_team_key === homeTeamId) {\n                transformedData.summary.goals.firstTeam += homeScore;\n                transformedData.summary.goals.secondTeam += awayScore;\n              } else {\n                transformedData.summary.goals.firstTeam += awayScore;\n                transformedData.summary.goals.secondTeam += homeScore;\n              }\n\n              // Get team logos - if not available in API response, use the ones from our mock data\n              const homeTeamLogo = match.home_team_key === homeTeamId ? matchData.homeTeam.logo : matchData.awayTeam.logo;\n              const awayTeamLogo = match.away_team_key === homeTeamId ? matchData.homeTeam.logo : matchData.awayTeam.logo;\n\n              // Create a memory-optimized match object with only necessary properties\n              const newMatch = {\n                id: match.event_key,\n                date: match.event_date,\n                homeTeam: {\n                  id: `team-${match.home_team_key}`,\n                  name: match.event_home_team,\n                  logo: homeTeamLogo\n                },\n                awayTeam: {\n                  id: `team-${match.away_team_key}`,\n                  name: match.event_away_team,\n                  logo: awayTeamLogo\n                },\n                score: {\n                  home: homeScore,\n                  away: awayScore\n                },\n                status: match.event_status || 'Finished',\n                league: {\n                  id: match.league_key,\n                  name: match.league_name,\n                  country: match.country_name\n                },\n                startTime: match.event_date + 'T' + (match.event_time || '00:00:00'),\n                // Simplified to save memory\n                odds: {\n                  home: 0,\n                  draw: 0,\n                  away: 0\n                },\n                probability: {\n                  home: '0%',\n                  draw: '0%',\n                  away: '0%'\n                }\n              };\n\n              // Add result as a custom property that our component will handle\n              // TypeScript won't complain about this since we're using \"as any\"\n              return {\n                ...newMatch,\n                result\n              };\n            });\n            transformedData.matches = processedMatches;\n          }\n\n          // Log detailed information for debugging\n          console.log('Transformed H2H data:', transformedData);\n          console.log(`Goals Summary: ${transformedData.firstTeam.name} (${transformedData.summary.goals.firstTeam}) - ${transformedData.secondTeam.name} (${transformedData.summary.goals.secondTeam})`);\n          console.log(`Total goals: ${transformedData.summary.goals.firstTeam + transformedData.summary.goals.secondTeam}`);\n          console.log(`Average goals per match: ${((transformedData.summary.goals.firstTeam + transformedData.summary.goals.secondTeam) / transformedData.summary.totalMatches).toFixed(1)}`);\n\n          // Set the data for rendering\n          setH2hData(transformedData);\n\n          // Log out the transformed data\n          console.log(`Successfully processed ${transformedData.matches.length} head-to-head matches`);\n          console.log(`${transformedData.firstTeam.name} wins: ${transformedData.summary.wins.firstTeam}`);\n          console.log(`${transformedData.secondTeam.name} wins: ${transformedData.summary.wins.secondTeam}`);\n          console.log(`Draws: ${transformedData.summary.wins.draws}`);\n        } else {\n          setError('Failed to fetch head-to-head data');\n        }\n      } catch (err) {\n        console.error('Error fetching H2H data:', err);\n        // Provide a more specific error message\n        if (err instanceof Error) {\n          setError(`Error fetching head-to-head data: ${err.message}`);\n        } else {\n          setError('Error fetching head-to-head data: Unknown error');\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchH2HData();\n  }, [matchData.homeTeam.id, matchData.awayTeam.id]);\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      centerContent: true,\n      py: 10,\n      children: /*#__PURE__*/_jsxDEV(Spinner, {\n        size: \"xl\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 738,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 737,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      centerContent: true,\n      py: 10,\n      children: /*#__PURE__*/_jsxDEV(ErrorMessage, {\n        message: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 746,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 745,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Box, {\n    bg: bgColor,\n    minH: \"100vh\",\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      maxW: \"container.xl\",\n      py: 5,\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        bg: bgColor,\n        p: 4,\n        borderRadius: \"md\",\n        boxShadow: \"sm\",\n        mb: 4,\n        children: [/*#__PURE__*/_jsxDEV(MatchHeader, {\n          match: matchData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 755,\n          columnNumber: 11\n        }, this), \"            \", /*#__PURE__*/_jsxDEV(Box, {\n          mt: 2,\n          p: 2,\n          bg: \"blue.50\",\n          borderRadius: \"md\",\n          fontSize: \"sm\",\n          color: \"blue.700\",\n          children: /*#__PURE__*/_jsxDEV(Flex, {\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            children: [/*#__PURE__*/_jsxDEV(Box, {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Data Source:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 766,\n                columnNumber: 19\n              }, this), \" AllSportsAPI - Real H2H data for \", matchData.homeTeam.name, \" vs \", matchData.awayTeam.name, \"(Updated: \", new Date().toLocaleDateString(), \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 765,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Flex, {\n              alignItems: \"center\",\n              gap: 2,\n              children: [/*#__PURE__*/_jsxDEV(Badge, {\n                colorScheme: \"blue\",\n                fontSize: \"sm\",\n                children: [\"Analyzing: Last \", gameCount, \" matches\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 770,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n                label: \"Clear all data cache\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  size: \"xs\",\n                  colorScheme: \"blue\",\n                  variant: \"ghost\",\n                  onClick: () => {\n                    cornerStatsService.clearCornerStatsCache();\n                    cardStatsService.clearCardStatsCache();\n                    bttsStatsService.clearBTTSStatsCache();\n                    playerStatsService.clearPlayerStatsCache();\n                    leagueService.clearLeagueStandingsCache();\n                    // Refresh all stats with force refresh\n                    fetchCornerStatsData(gameCount);\n                    fetchCardStatsData(gameCount);\n                    fetchBTTSStatsData(gameCount);\n                    fetchPlayerStatsData(gameCount);\n                    fetchLeagueStandingsData();\n                  },\n                  children: \"Reset Cache\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 772,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 771,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 769,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 756,\n          columnNumber: 65\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 754,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        mt: 6,\n        children: /*#__PURE__*/_jsxDEV(Tabs, {\n          isFitted: true,\n          variant: \"enclosed\",\n          colorScheme: \"blue\",\n          index: tabIndex,\n          onChange: index => {\n            console.log(`Switching to tab index ${index}, keeping gameCount: ${gameCount}`);\n            setTabIndex(index);\n          },\n          children: [/*#__PURE__*/_jsxDEV(TabList, {\n            mb: \"1em\",\n            children: [/*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"Head to Head\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 803,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"Corner Stats\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 804,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"Card Stats\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 805,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"BTTS Stats\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 806,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"Player Stats\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 807,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Tab, {\n              fontWeight: \"medium\",\n              children: \"League\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 808,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 802,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TabPanels, {\n            children: [/*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: /*#__PURE__*/_jsxDEV(CustomHeadToHeadTab, {\n                match: matchData,\n                data: h2hData,\n                isLoading: false,\n                initialMatchRange: gameCount\n              }, h2hData ? `h2h-${h2hData.summary.wins.firstTeam}-${h2hData.summary.wins.secondTeam}-${h2hData.summary.wins.draws}-${h2hData.summary.goals.firstTeam}-${h2hData.summary.goals.secondTeam}-${gameCount}` : 'h2h-loading', false, {\n                fileName: _jsxFileName,\n                lineNumber: 814,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 812,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: [console.log(\"Corner stats data in SpecialMatch:\", cornerStatsData), /*#__PURE__*/_jsxDEV(CornerTabCustom, {\n                match: matchData,\n                data: cornerStatsData,\n                isLoading: !cornerStatsData && !error,\n                initialGameCount: gameCount.toString(),\n                onRefresh: fetchCornerStatsData\n              }, gameCount + \"-\" + (cornerStatsData ? 'data' : 'no-data'), false, {\n                fileName: _jsxFileName,\n                lineNumber: 825,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 822,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: [console.log(\"Card stats data in SpecialMatch:\", cardStatsData), /*#__PURE__*/_jsxDEV(CustomCardsTab, {\n                match: matchData,\n                data: cardStatsData,\n                isLoading: !cardStatsData && !error,\n                initialGameCount: gameCount.toString(),\n                onRefresh: fetchCardStatsData\n              }, gameCount + \"-\" + (cardStatsData ? 'data' : 'no-data'), false, {\n                fileName: _jsxFileName,\n                lineNumber: 837,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: [console.log(\"BTTS stats data in SpecialMatch:\", bttsStatsData), /*#__PURE__*/_jsxDEV(CustomBTTSTab, {\n                match: matchData,\n                data: bttsStatsData,\n                isLoading: !bttsStatsData && !error,\n                initialGameCount: gameCount.toString(),\n                onRefresh: fetchBTTSStatsData\n              }, gameCount + \"-\" + (bttsStatsData ? 'data' : 'no-data'), false, {\n                fileName: _jsxFileName,\n                lineNumber: 849,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 846,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: [console.log(\"Player stats data in SpecialMatch:\", playerStatsData), /*#__PURE__*/_jsxDEV(CustomPlayerStatsTab, {\n                match: matchData,\n                data: playerStatsData,\n                isLoading: !playerStatsData && !error,\n                initialGameCount: gameCount.toString(),\n                onGameCountChange: count => {\n                  console.log(`Changing game count to ${count} from Player Stats tab`);\n                  // Dispatch the same event as other tabs\n                  const customEvent = new CustomEvent('gameCountChange', {\n                    detail: {\n                      gameCount: count,\n                      requiresRefetch: true\n                    },\n                    bubbles: true\n                  });\n                  document.dispatchEvent(customEvent);\n                },\n                onRefresh: fetchPlayerStatsData\n              }, gameCount + \"-\" + (playerStatsData ? 'data' : 'no-data'), false, {\n                fileName: _jsxFileName,\n                lineNumber: 861,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 858,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: /*#__PURE__*/_jsxDEV(CustomLeagueTab, {\n                match: matchData,\n                data: leagueStandingsData,\n                isLoading: !leagueStandingsData && !error,\n                onRefresh: fetchLeagueStandingsData\n              }, \"league-standings\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 882,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 881,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TabPanel, {\n              p: 0,\n              children: /*#__PURE__*/_jsxDEV(OverUnderMarketTab, {\n                match: matchData,\n                isLoading: false,\n                onRefresh: () => {\n                  console.log(\"Refreshing over/under market data\");\n                  // In a real implementation, you would fetch fresh market data here\n                }\n              }, \"over-under-markets\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 893,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 892,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 811,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 798,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 797,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 753,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 752,\n    columnNumber: 5\n  }, this);\n};\nexport default SpecialMatch;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}